{
  "id": "beads-20260206-203-sub-01",
  "parent_id": "beads-20260206-203",
  "title": "Install dependencies and add foundational ShadCN UI components",
  "status": "completed",
  "phase": "implementation",
  "files": [
    "apps/web/package.json",
    "apps/web/src/hooks/use-mobile.ts",
    "apps/web/src/components/ui/skeleton.tsx",
    "apps/web/src/components/ui/separator.tsx",
    "apps/web/src/components/ui/tooltip.tsx",
    "apps/web/src/components/ui/button.tsx"
  ],
  "depends_on": [],
  "commits": ["726fa22"],
  "contested_tests": [
    {
      "test_file": "apps/web/src/__tests__/hooks/use-mobile.test.ts",
      "test_name": "cleans up event listener on unmount",
      "rationale": "The test mock creates a new object with independent vi.fn() instances for each window.matchMedia() call. The test gets removeEventListenerMock from window.matchMedia('').removeEventListener (call #2), but unmount cleanup calls removeEventListener on the mql object from the hook's window.matchMedia('(max-width: 768px)') call (#1). Since each mockImplementation invocation returns a new object with its own vi.fn() for removeEventListener, the mock the test asserts on was never called. The hook implementation correctly cleans up by calling mql.removeEventListener('change', onChange) in the useEffect cleanup.",
      "suggested_fix": "Store the matchMedia mock return value before rendering the hook, or restructure the mock to return a shared object. For example: 'const mockMql = { matches: currentMatches, ..., removeEventListener: vi.fn(...) }; window.matchMedia = vi.fn(() => mockMql);' Then assert mockMql.removeEventListener was called after unmount."
    }
  ],
  "created_at": "2026-02-06T14:30:00Z",
  "updated_at": "2026-02-06T14:30:00Z"
}
